<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ch999.express.admin.mapper.UserInfoMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.ch999.express.admin.entity.UserInfo">
        <id column="id" property="id" />
        <result column="user_name" property="userName" />
        <result column="real_name" property="realName" />
        <result column="student_number" property="studentNumber" />
        <result column="avatar" property="avatar" />
        <result column="pwd" property="pwd" />
        <result column="mobil" property="mobil" />
        <result column="authentication_flag" property="authenticationFlag" />
        <result column="del_flag" property="delFlag" />
    </resultMap>

    <select id="selectCenterInfo" resultType="map">
       SELECT
	u.id,
CASE
	WHEN t.orderNum is NULL
	THEN
	0 ELSE t.orderNum
	END AS orderNum,
CASE
	WHEN k.pickUpNum is NULL
	THEN
	0 ELSE k.pickUpNum
	END AS pickUpNum
FROM
	user_info u
	LEFT JOIN ( SELECT count( 1 ) AS orderNum, eo.create_user FROM express_order eo WHERE eo.create_user = #{userId} and eo.del_flag = 0 ) t ON t.create_user = u.id
	LEFT JOIN ( SELECT COUNT( 1 ) AS pickUpNum, eu.userId FROM express_user eu WHERE eu.userId = #{userId} and eu.del_flag = 0) k ON k.userId = u.id
WHERE
	u.id = #{userId}
    </select>

</mapper>
